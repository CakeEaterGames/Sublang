
//Equivalent to out = addr[offset]
function geti(addr, offset, out){
	set(geti+5, cb)
	set(geti+6, addr)
	set(geti+7, offset)

	jump(geti)
	cb: comeback,
	comeback:
	set(out,_return1)
}

function _geti()
{
	jump(skipVars)
		ret: jump(0),
		addr: 0,
		offset: 0,
		temp: 0,
	skipVars:
 
	clear(getpart)
	clear(temp)
	sub(temp, addr)
	sub(temp, offset)
	sub(getpart, temp)

	clear(_return1)
	clear(temp)

	getpart:
	sub(temp, 0)
	sub(_return1, temp)
 

	jump(ret)
}

//Equivalent to addr[offset] = val
function seti(addr, offset, val){
	set(seti+5, cb)
	set(seti+6, addr)
	set(seti+7, offset)
	set(seti+8, val)

	jump(seti)
	cb: comeback,
	comeback:
 
}

function _seti()
{
	jump(skipVars)
		ret: jump(0),
		addr: 0,
		offset: 0,
		val: 0,
		temp: 0,
	skipVars:

	clear(temp)
	sub(temp, addr)
	sub(temp, offset)
		
	clear(clearpart)
	sub(clearpart,temp)

	clear(clearpart+1)
	sub(clearpart+1,temp)

	clear(setpart+1)
	sub(setpart+1, temp)
	 
	clear(temp)
	sub(temp,val)

	clearpart:
	sub(0, 0)
	setpart:
	sub(0, temp)


	jump(ret)
}


function push(stack,val)
{
	inc(stack)
	seti(stack,zero,val)
}
function pop(stack,val)
{
	geti(stack,zero,val)
	dec(stack)
}
function push(val)
{
	push(_stack,val)
}
function pop(val)
{
	pop(_stack,val)
}